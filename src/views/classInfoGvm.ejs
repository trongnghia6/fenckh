<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H·ªçc Vi·ªán K·ªπ Thu·∫≠t M·∫≠t M√£</title>
    <link rel="stylesheet" href="/css/table.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <link rel="stylesheet" href="/css/styles.css" />
    <link rel="stylesheet" href="/css/gvmList.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />

    <style>
      /* nmsvbmbvsmnvds */
      .teacher-group {
        border: 2px solid black;
        /* Vi·ªÅn ƒëen xung quanh nh√≥m gi·∫£ng vi√™n */
        border-collapse: separate;
        margin-bottom: 10px;
      }

      .teacher-group td,
      .teacher-group th {
        padding: 8px;
        text-align: left;
        border: 2px solid black;
        /* Vi·ªÅn ƒëen xung quanh nh√≥m gi·∫£ng vi√™n */
      }
    </style>
<style>
  body {
    font-family: Arial, sans-serif;
  }
  
  .class-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    table-layout: auto; /* Cho ph√©p b·∫£ng t·ª± ƒëi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc c·ªôt */
  }
  
  .class-table th, .class-table td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    white-space: normal; /* Cho ph√©p xu·ªëng d√≤ng */
    word-wrap: break-word; /* Chia t·ª´ v√† xu·ªëng d√≤ng khi c·∫ßn */
  }
  
  .class-table th {
    background-color: #007BFF; /* ƒê·ªïi m√†u n·ªÅn ti√™u ƒë·ªÅ th√†nh xanh d∆∞∆°ng */
    color: white;
    font-weight: bold;
  }
  
  .class-table tbody tr:nth-child(even) {
    background-color: #f2f2f2;
  }
  
  .class-table tbody tr:hover {
    background-color: #ddd;
  }
  
  .action-button {
    background-color: #4CAF50;
    color: white;
    padding: 5px 10px;
    border: none;
    cursor: pointer;
    border-radius: 5px;
  }
  
  .action-button:hover {
    background-color: #45a049;
  }
  
  /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc c√°c c·ªôt */
  .class-table th, .class-table td {
    min-width: 50px; /* ƒê·∫∑t k√≠ch th∆∞·ªõc t·ªëi thi·ªÉu cho c·ªôt ƒë·ªÉ kh√¥ng b·ªã qu√° h·∫πp */
  }
  
</style>
    <!-- Ph√¢n quy·ªÅn -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        //const role = localStorage.getItem("userRole");
        const MaPhongBan = localStorage.getItem("MaPhongBan");
        // ·∫®n ph·∫ßn l·ªçc khoa n·∫øu role l√† Khoa
        const departmentFilter = document.getElementById("departmentFilter");

        if (
          !MaPhongBan.includes("DAOTAO") &&
          !MaPhongBan.includes("TAICHINH")
        ) {
          departmentFilter.style.display = "none";
        }
      });
    </script>
  </head>

  <body>
    <nav class="navbar-top">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img src="/Logo-Hoc-Vien-Ky-Thuat-Mat-Ma-ACTVN.webp" alt="Logo" />
          <div class="navbar-title">
            <img src="/dongchu_banner.png" alt="banner" />
          </div>
        </a>
      </div>
    </nav>

    <!-- Ph·∫ßn d∆∞·ªõi c·ªßa navbar ch·ª©a c√°c m·ª•c n·∫±m ngang -->
    <nav class="navbar navbar-expand-lg navbar-bottom sticky-top">
      <div class="" style="width: 100%">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div
          class="collapse navbar-collapse"
          style="width: 100%"
          id="navbarNav"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" id="Home" href=""
                ><i class="fa-solid fa-house"></i
              ></a>
            </li>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  Gi·∫£ng Vi√™n M·ªùi
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" href="/gvmList"
                    >Danh s√°ch gi·∫£ng vi√™n m·ªùi</a
                  >
                  <a class="nav-link" id="actionButton1" href="/importGvmList" style="width: 100%;">Th√™m gi·∫£ng vi√™n m·ªùi b·∫±ng file</a>
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  B·∫£ng Quy Chu·∫©n
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" href="/import" id="actionButton2" style="width: 100%;">Th√™m file quy chu·∫©n</a>

                  <a class="nav-link" href="/tableTam"
                    >B·∫£ng quy chu·∫©n d·ª± ki·∫øn</a
                  >
                  <a class="nav-link" href="/tableQC"
                    >B·∫£ng quy chu·∫©n ch√≠nh th·ª©c</a
                  >
                  <a class="nav-link" id="ThongTinGD" href=""
                    >Th√¥ng tin gi·∫£ng vi√™n theo l·ªõp</a
                  >
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle active"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  M·ªùi Gi·∫£ng
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" href="/xemCacLopGvm">Xem c√°c l·ªõp m·ªùi</a>

                  <a class="nav-link active" href="/classInfoGvm"
                    >Th√¥ng tin l·ªõp gi·∫£ng vi√™n m·ªùi</a
                  >
                  <a class="nav-link" href="/infoHDGvm" role="button"
                    >Th√¥ng tin h·ª£p ƒë·ªìng</a
                  >
                  <li class="nav-item"></li>
                  <a class="nav-link " href="/phuLucHD" >Ph·ª• l·ª•c h·ª£p ƒë·ªìng</a>
                  </li>
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  V∆∞·ª£t Gi·ªù
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" id="ThongTinGD" href="#">COMING SOON</a>
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  Nghi√™n C·ª©u Khoa H·ªçc
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" id="ThongTinGD" href="#">COMING SOON</a>
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  ƒê·ªì √Ån
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" id="ThongTinGD" href="#">COMING SOON</a>
                </div>
              </div>
            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="/login"
                  id="navbarDropdownUser"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  Th·ªëng K√™
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" id="ThongTinGD" href="#">COMING SOON</a>
                </div>
              </div>

            </div>
            <div class="navbar-nav">
              <div class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownUser" data-bs-toggle="dropdown"
                  aria-expanded="false">
                   H·ªá Th·ªëng
                </a>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="nav-link" id="" href="log">Xem File Log</a>
                </div>
              </div>
            </div>
          </ul>
          <div class="navbar-nav">
            <div class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle fullname"
                href="/login"
                id="navbarDropdownUser"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Hi, L√™ ƒê·ª©c Thu·∫≠n
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" href="#">Th√¥ng tin c√° nh√¢n</a>
                <a class="dropdown-item" id="changePasswordLink">ƒê·ªïi m·∫≠t kh·∫©u</a>
                <a class="dropdown-item" href="/">ƒêƒÉng xu·∫•t</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <div class="container-fluid m-4 box">
      <div class="d-flex justify-content-center">
        <!-- Main content -->
        <div class="gvmList" style="width: 100%">
          <div class="m-3">
            <div class="">
              <h1>TH√îNG TIN C√ÅC L·ªöP GI·∫¢NG VI√äN M·ªúI</h1>
              <div class="header-actions"  style="height: 45px;">

                <!-- <button class="add-class" onclick="addClass()">+ Th√™m gi·∫£ng vi√™n m·ªùi</button> -->
                <input
                  type="text"
                  placeholder="T√¨m ki·∫øm theo T√™n..."
                  class="search"
                  id="searchInput"
                  onkeyup="searchClass()"
                />
                
              <div class="loc" style="margin-top: -15px;">
                <select class="selectop" id="combobox-dot">
                  <option value="1">ƒê·ª£t 1</option>
                  <option value="2">ƒê·ª£t 2</option>
                </select>
        
                <!-- Combo box k√¨ -->
                <select class="selectop" id="combobox-ki">
                  <option value="1">K·ª≥ 1</option>
                  <option value="2">K·ª≥ 2</option>
                </select>
        
                <!-- Combo box NƒÉm -->
                <select class="selectop" id="NamHoc">
                  <option value="">NƒÉm h·ªçc</option>
                </select>
                <select class="selectop" id="departmentFilter">
                  <option value="">Ch·ªçn khoa</option>
                </select>
                
                <script>
                  function filterTable() {
                    // Get selected values
                    let dot = document.getElementById("combobox-dot").value;
                    let ki = document.getElementById("combobox-ki").value;
                    let nam = document.getElementById("NamHoc").value;
                    let department = document.getElementById("departmentFilter").value.trim();
                
                    let tbody = document.getElementById("data-table-body");
                    let rows = tbody.getElementsByTagName("tr");
                
                    for (let i = 0; i < rows.length; i++) {
                      let row = rows[i];
                      let rowDepartment = row.getAttribute("data-department");
                      let rowDot = row.getAttribute("data-dot");
                      let rowKi = row.getAttribute("data-ki");
                      let rowNam = row.getAttribute("data-nam");
                
                      // Filtering logic
                      let matchesDepartment = department === "" || rowDepartment === department;
                      let matchesDot = dot === "" || rowDot === dot;
                      let matchesKi = ki === "" || rowKi === ki;
                      let matchesNam = nam === "" || rowNam === nam;
                
                      // Show or hide row based on filter results
                      if (matchesDepartment && matchesDot && matchesKi && matchesNam) {
                        row.style.display = ""; // Show row
                      } else {
                        row.style.display = "none"; // Hide row
                      }
                    }
                  }
                </script>
                <button class="button text-nowrap" id="render" 
                  style="margin-top: 17px;" 
                  onclick="filterTable()">Hi·ªÉn th·ªã
                </button>
                </div>
              </div>

              <table class="class-table" id="classTable">
                <thead>
                  <tr>
                    <th>STT</th>
                    <th>Gi·∫£ng vi√™n</th>
                    <th>M√¥n h·ªçc</th>
                    <th>T√™n l·ªõp</th>
                    <th>S·ªë t√≠n ch·ªâ</th>
                    <th>ƒê·ª£t</th>
                    <th>K·ª≥</th>
                    <th>NƒÉm</th>
                    <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                    <th>Ng√†y k·∫øt th√∫c</th>
                    <th>S·ªë ti·∫øt</th>
                    <th>T·ªïng s·ªë ti·∫øt</th>
                    <th>M√£ h·ªçc ph·∫ßn</th>
                    <!-- C·ªôt Khoa -->
                    <th>Chi ti·∫øt gi·∫£ng vi√™n m·ªùi</th>
                  </tr>
                </thead>
                <tbody class="teacher-group" id="data-table-body">
                  <% let index = 1; %> 
                  <% for (let teacher of Object.keys(GiangDay)) { %> 
                    <% let courses = GiangDay[teacher]; %> 
                    <% let totalSoTiet = courses.reduce((total, course) => total + course.QuyChuan, 0); %>
                    <tr class="teacher-group" data-department="<%= courses[0].Khoa %>" data-dot="<%= courses[0].Dot %>" data-ki="<%= courses[0].KiHoc %>" data-nam="<%= courses[0].NamHoc %>">
                      <% courses.forEach((course, courseIndex) => { %>
                        <tr data-department="<%= course.Khoa %>" data-dot="<%= course.Dot %>" data-ki="<%= course.KiHoc %>" data-nam="<%= course.NamHoc %>">
                          <% if (courseIndex === 0) { %>
                            <td rowspan="<%= courses.length %>"><%= index %></td>
                            <td rowspan="<%= courses.length %>"><%= course.GiaoVienGiangDay %></td>
                            <% index++; %> 
                          <% } %>
                          <td><%= course.LopHocPhan %></td>
                          <td><%= course.TenLop %></td>
                          <td><%= course.SoTinChi %></td>
                          <td><%= course.Dot %></td>
                          <td><%= course.KiHoc %></td>
                          <td><%= course.NamHoc %></td>
                          <% function formatDate(dateStr) { %>
                            <% if (!dateStr) return 'N/A'; %>
                            <% const date = new Date(dateStr); %>
                            <% if (isNaN(date.getTime())) return 'N/A'; %>
                            <% const day = String(date.getDate()).padStart(2, '0'); %>
                            <% const month = String(date.getMonth() + 1).padStart(2, '0'); %>
                            <% const year = date.getFullYear(); %>
                            <% return `${day}/${month}/${year}`; %>
                          <% } %>
                          
                          <td><%= formatDate(course.NgayBatDau) %></td>
                          <td><%= formatDate(course.NgayKetThuc) %></td>
                          <td><%= course.QuyChuan %></td>
                          
                          <% if (courseIndex === 0) { %>
                            <td rowspan="<%= courses.length %>"><%= totalSoTiet %></td>
                            <td rowspan="<%= courses.length %>"><%= course.Khoa %></td>
                            <td rowspan="<%= courses.length %>">
                              <button class="action-button view" onclick="viewClass(this, '<%= parseInt(course.id_Gvm) - 1 %>')">üëÅÔ∏è</button>
                            </td>
                          <% } %>
                        </tr>
                      <% }); %>
                    </tr>
                  <% } %>
                </tbody>
                
              </table>
              <!-- <div class="pagination">
                              <span>10 / trang</span>
                              <button class="page-button">1</button>
                            </div> -->
            </div>

            <div id="modal" class="modal" style="display: none">
              <div class="modal-content">
                <span class="close-button" onclick="closeModal()">√ó</span>
                <h2 id="modal-title">Chi ti·∫øt gi·∫£ng vi√™n m·ªùi</h2>
                <br />
                <p>
                  <strong>M√£ gi·∫£ng vi√™n:</strong> <span id="modal-ma-gv"></span>
                </p>
                <p><strong>H·ªç t√™n:</strong> <span id="modal-ho-ten"></span></p>
                <p>
                  <strong>Ng√†y sinh:</strong> <span id="modal-ngay-sinh"></span>
                </p>
                <p><strong>CCCD:</strong> <span id="modal-cccd"></span></p>
                <p>
                  <strong>Ng√†y c·∫•p CCCD:</strong>
                  <span id="modal-ngay-cap"></span>
                </p>
                <p>
                  <strong>N∆°i c·∫•p CCCD:</strong>
                  <span id="modal-noi-cap"></span>
                </p>
                <p>
                  <strong>ƒê·ªãa ch·ªâ theo CCCD:</strong>
                  <span id="modal-dia-chi-cccd"></span>
                </p>
                <p>
                  <strong>S·ªë t√†i kho·∫£n:</strong> <span id="modal-so-tk"></span>
                </p>
                <p>
                  <strong>Ng√¢n h√†ng:</strong> <span id="modal-ngan-hang"></span>
                </p>
                <p><strong>Email:</strong> <span id="modal-email"></span></p>
                <p>
                  <strong>H·ªá s·ªë l∆∞∆°ng:</strong>
                  <span id="modal-heso-luong"></span>
                </p>
                <p>
                  <strong>N∆°i c√¥ng t√°c:</strong>
                  <span id="modal-noi-cong-tac"></span>
                </p>
                <p>
                  <strong>Ch·ª©c v·ª•:</strong> <span id="modal-chuc-vu"></span>
                </p>
                <p>
                  <strong>M√£ s·ªë thu·∫ø:</strong>
                  <span id="modal-ma-so-thue"></span>
                </p>
                <p>
                  <strong>T·ªët nghi·ªáp lo·∫°i:</strong>
                  <span id="modal-tot-nghiep-loai"></span>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
      document.addEventListener("DOMContentLoaded", () => {
          const isKhoa = localStorage.getItem("isKhoa");
  
          // ·∫®n button ngay khi trang ƒë∆∞·ª£c t·∫£i
          const actionButton = document.getElementById('actionButton');
              const actionButton1 = document.getElementById('actionButton1');
      const actionButton2 = document.getElementById('actionButton2');
  
      if (isKhoa == 0) {
              actionButton1.style.display = 'none'; // ·∫®n actionButton1 n·∫øu isKhoa = 0
              actionButton2.style.display = 'inline-block'; // Hi·ªán actionButton2
              
          } else {
              actionButton1.style.display = 'inline-block'; // Hi·ªán actionButton1 n·∫øu isKhoa kh√°c 0
              actionButton2.style.display = 'none'; // ·∫®n actionButton2
              
          }
        });
  </script>
    
    <!-- <script>
        function filterGvmByDepartment() {
          var filter = document.getElementById("departmentFilter").value;
          var table = document.getElementById("classTable");
          var tbody = document.getElementById("teacher-group");
          var rows = tbody.getElementsByTagName("tr");

          for (var i = 0; i < rows.length; i++) {
            var row = rows[i];
            var department = row.getAttribute("data-department");

            if (filter === "" || department === filter) {
              row.style.display = "";
            } else {
              row.style.display = "none";
            }
          }
        }
      </script> -->

    <script>
      // T√¨m ki·∫øm gi·∫£ng vi√™n m·ªùi theo t√™n
      function searchClass() {
        let input = document.getElementById("searchInput").value.toLowerCase();
        let table = document.getElementById("classTable");
        let rows = table.getElementsByTagName("tr");

        let currentGroup = null;
        let groupVisible = false;

        for (let i = 1; i < rows.length; i++) {
          // B·∫Øt ƒë·∫ßu t·ª´ 1 ƒë·ªÉ b·ªè qua h√†ng ti√™u ƒë·ªÅ
          let row = rows[i];

          if (row.classList.contains("teacher-group")) {
            // ƒê√¢y l√† h√†ng ƒë·∫ßu ti√™n c·ªßa m·ªôt nh√≥m gi·∫£ng vi√™n m·ªõi
            if (currentGroup) {
              // ·∫®n/hi·ªán nh√≥m tr∆∞·ªõc ƒë√≥ d·ª±a tr√™n k·∫øt qu·∫£ t√¨m ki·∫øm
              setGroupVisibility(currentGroup, groupVisible);
            }

            currentGroup = [];
            groupVisible = false;
          }

          currentGroup.push(row);

          let teacherNameCell = row.cells[1]; // Gi·∫£ s·ª≠ t√™n gi·∫£ng vi√™n ·ªü c·ªôt th·ª© 2
          if (teacherNameCell) {
            let teacherName = teacherNameCell.textContent.toLowerCase();
            if (teacherName.includes(input)) {
              groupVisible = true;
            }
          }
        }

        // X·ª≠ l√Ω nh√≥m cu·ªëi c√πng
        if (currentGroup) {
          setGroupVisibility(currentGroup, groupVisible);
        }
      }

      function setGroupVisibility(group, isVisible) {
        for (let row of group) {
          row.style.display = isVisible ? "" : "none";
        }
      }

      async function fetchGVMLists() {
        try {
          const response = await fetch("/api/classInfoGvm");
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          const gvmLists = await response.json();
          return gvmLists;
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }

      function viewClass(button, index) {
        var hre = "/viewGvm/" + index;
        window.location.href = hre;
      }


      // ƒê√≥ng modal
      function closeModal() {
        document.getElementById("modal").style.display = "none";
      }

      // Th√™m s·ª± ki·ªán khi nh·∫•n ra ngo√†i modal ƒë·ªÉ ƒë√≥ng modal
      window.onclick = function (event) {
        let modal = document.getElementById("modal");
        if (event.target == modal) {
          modal.style.display = "none";
        }
      };
    </script>

    <script>
      // L·∫•y query string t·ª´ URL
      const urlParams = new URLSearchParams(window.location.search);
      const message = urlParams.get("message");

      // L·∫•y ph·∫ßn t·ª≠ div ƒë·ªÉ hi·ªÉn th·ªã th√¥ng b√°o
      const messageDiv = document.getElementById("message");

      // console.log(message)
      // Hi·ªÉn th·ªã th√¥ng b√°o d·ª±a tr√™n gi√° tr·ªã c·ªßa message
      if (message === "insertSuccess") {
        alert("Update Success");
      } else if (message === "insertFalse") {
        alert("Update False");
      }

      // Sau khi hi·ªÉn th·ªã th√¥ng b√°o, x√≥a query string ƒë·ªÉ tr√°nh hi·ªÉn th·ªã l·∫°i khi refresh
      if (message) {
        // S·ª≠ d·ª•ng window.history ƒë·ªÉ x√≥a query string m√† kh√¥ng refresh l·∫°i trang
        const newUrl = window.location.origin + window.location.pathname;
        window.history.replaceState({}, document.title, newUrl);
      }
    </script>

    <!-- Ph·∫ßn ph√¢n quy·ªÅn -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {

        // Th√™m s·ª± ki·ªán click cho ph·∫ßn t·ª≠ c√≥ id="ThongTinGD"
        const ThongTinGD = document.getElementById("ThongTinGD");

        ThongTinGD.addEventListener("click", function (event) {
          event.preventDefault(); // NgƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa li√™n k·∫øt
          const isKhoa = localStorage.getItem("isKhoa"); // L·∫•y role t·ª´ localStorage

          if (isKhoa == 0) {
            // N·∫øu l√† ƒë√†o t·∫°o ho·∫∑c t√†i ch√≠nh
            window.location.href = "/info2";
          } else {
            window.location.href = "/info";
          }
        });

        // Th√™m s·ª± ki·ªán click cho ph·∫ßn t·ª≠ c√≥ id="Home"

        const Home = document.getElementById("Home");

        Home.addEventListener("click", function (event) {
          event.preventDefault(); // NgƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa li√™n k·∫øt

          const isKhoa = localStorage.getItem("isKhoa");

          if (isKhoa == 0) {
            // N·∫øu l√† ƒë√†o t·∫°o ho·∫∑c t√†i ch√≠nh
            window.location.href = "/maindt";
          } else {
            window.location.href = "/mainkhoa";
          }
        });
      });
    </script>

    <script>
      window.onload = function () {
        const TenNhanVien = localStorage.getItem("TenNhanVien"); // L·∫•y t√™n ng∆∞·ªùi d√πng t·ª´ localStorage
        const Role = localStorage.getItem("userRole");

        if (TenNhanVien) {
          // Hi·ªÉn th·ªã t√™n ng∆∞·ªùi d√πng tr√™n ph·∫ßn t·ª≠ HTML
          document.querySelector(
            ".fullname"
          ).innerText = `${TenNhanVien} - ${Role}`;
        } else {
          document.querySelector(".fullname").innerText = "Hi, Guest"; // Hi·ªÉn th·ªã n·∫øu kh√¥ng c√≥ t√™n ng∆∞·ªùi d√πng
        }

        document.querySelector(".role").innerText = `${Role}`;
      };

      
    </script>
    <script>
      document.getElementById("changePasswordLink").addEventListener("click", function(event) {
    event.preventDefault(); // NgƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa th·∫ª a
    const tenDangNhap = localStorage.getItem("TenDangNhap"); // L·∫•y TenDangNhap t·ª´ localStorage
    alert(tenDangNhap);

    if (tenDangNhap) {
        // Chuy·ªÉn h∆∞·ªõng ƒë·∫øn trang changePassword v√† truy·ªÅn TenDangNhap trong URL
        window.location.href = `/changePassword?tenDangNhap=${encodeURIComponent(tenDangNhap)}`;
    } else {
        alert("Kh√¥ng t√¨m th·∫•y TenDangNhap trong localStorage.");
    }
});
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
          const isKhoa = localStorage.getItem("isKhoa");
  
          // ·∫®n button ngay khi trang ƒë∆∞·ª£c t·∫£i
          const actionButton = document.getElementById('actionButton');
              const actionButton1 = document.getElementById('actionButton1');
      const actionButton2 = document.getElementById('actionButton2');
  
      if (isKhoa == 0) {
              actionButton1.style.display = 'none'; // ·∫®n actionButton1 n·∫øu isKhoa = 0
              actionButton2.style.display = 'inline-block'; // Hi·ªán actionButton2
              
          } else {
              actionButton1.style.display = 'inline-block'; // Hi·ªán actionButton1 n·∫øu isKhoa kh√°c 0
              actionButton2.style.display = 'none'; // ·∫®n actionButton2
              
          }
        });
  </script>
  <script>
    $(document).ready(function() {
  $('#NamHoc option[value=""]').remove();

  $.ajax({
    url: '/getNamHoc',
    method: 'GET',
    success: function(response) {
      if (response.success) {
        const NamHoc = response.NamHoc;
        console.log(NamHoc);

        response.NamHoc.forEach(function(item) {
          if (item.NamHoc === NamHoc) {
            $('#NamHoc').prepend(
              `<option value="${item.NamHoc}" selected>${item.NamHoc}</option>`
            );
          } else {
            $('#NamHoc').append(
              `<option value="${item.NamHoc}">${item.NamHoc}</option>`
            );
          }
        });

        if (!$('#NamHoc option:selected').length) {
          $('#NamHoc').prepend('<option value="">Ch·ªçn NƒÉm H·ªçc</option>');
        }
      } else {
        console.error("Kh√¥ng l·∫•y ƒë∆∞·ª£c d·ªØ li·ªáu nƒÉm h·ªçc:", response.message);
      }
    },
    error: function(error) {
      console.error("L·ªói khi l·∫•y d·ªØ li·ªáu nƒÉm h·ªçc:", error);
    }
  });
});
</script>
<script>
  $(document).ready(function() {
      $('#departmentFilter option[value=""]').remove();
    // G·ªçi AJAX ƒë·ªÉ l·∫•y d·ªØ li·ªáu JSON t·ª´ API
    $.ajax({
      url: '/getPhongBan', // ƒê∆∞·ªùng d·∫´n t·ªõi API getPhongBan
      method: 'GET',
      success: function(response) {
        // Ki·ªÉm tra n·∫øu response th√†nh c√¥ng
        const MaPhongBan = response.MaPhongBan;
        if (response.success) {
          $('#departmentFilter').prepend('<option value="ALL">T·∫•t c·∫£ khoa</option>');
          // L·∫∑p qua t·ª´ng m·ª•c trong m·∫£ng MaPhongBan
          response.MaPhongBan.forEach(function(item) {
            // N·∫øu item.MaPhongBan b·∫±ng boMon.MaPhongBan, hi·ªÉn th·ªã tr∆∞·ªõc
            console.log(item);
              $('#departmentFilter').append(
                `<option value="${item.MaPhongBan}">${item.MaPhongBan}</option>`
              );
            }
          );

          // N·∫øu kh√¥ng c√≥ ph√≤ng ban n√†o t∆∞∆°ng ·ª©ng, b·∫°n c√≥ th·ªÉ th√™m t√πy ch·ªçn m·∫∑c ƒë·ªãnh ·ªü ƒë√¢y
          if (!$('#departmentFilter option:selected').length) {
            $('#departmentFilter').prepend('<option value="">Ch·ªçn Ph√≤ng Ban</option>');
          }
        } else {
          console.error("Kh√¥ng l·∫•y ƒë∆∞·ª£c d·ªØ li·ªáu phongBan:", response.message);
        }
      },
      error: function(error) {
        console.error("L·ªói khi l·∫•y d·ªØ li·ªáu phongBan:", error);
      }
    });
  });
</script>

  </body>
</html>
