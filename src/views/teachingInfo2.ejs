<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Học Viện Kỹ Thuật Mật Mã</title>
  <link rel="stylesheet" href="/css/teachingInfo.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/bootstrap/dist/js/bootstrap.min.js">
  <style>
    .background-image {
      background: url('/picture/OIP.jfif') no-repeat center center;
      background-size: cover;
    }

    .grid-center {
      display: grid;
      place-items: center;
    }

    .home-link {
      color: white;
      text-decoration: none;
    }

    .w-20 {
      width: 20% !important;
    }

    .column .soTc {
      width: 25px;
    }

    .suggestions {
      border: 1px solid #ccc;
      max-height: 150px;
      overflow-y: auto;
      position: absolute;
      z-index: 1000;
      background: white;
    }

    .suggestions div {
      padding: 5px;
      cursor: pointer;
    }

    .suggestions div:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>

<body>
  <header class="bg-primary text-white py-2 background-image">
    <div class="container">
      <div class="d-flex">
        <div>
          <img src="../../picture/Logo-Hoc-Vien-Ky-Thuat-Mat-Ma-ACTVN.webp" alt="Logo" class="img-fluid"
            style="height: 102.4px;">
        </div>
        <div class="text-center">
          <h1>HỌC VIỆN KỸ THUẬT MẬT MÃ</h1>
          <h2>HỆ THỐNG QUẢN LÍ THÔNG TIN CHO GIẢNG VIÊN</h2>
        </div>
      </div>
    </div>
  </header>

  <nav class="bg-info py-2">
    <div class="d-flex">
      <div class="container d-flex justify-content-center grid-center">
        <div class="btn btn-primary text-nowrap mx-1">
          <a href="index.html" class="home-link">
            <i class="bi bi-house"></i> Home
          </a>
        </div>
        <div class="dropdown">
          <button class="btn btn-primary dropdown-toggle mx-1" type="button" id="dropdownMenuButton"
            data-bs-toggle="dropdown" aria-expanded="false">
            Quản lí hợp đồng
          </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li><a class="dropdown-item" href="#">Xem hợp đồng</a></li>
            <li><a class="dropdown-item" href="#">Thông tin giảng viên mời</a></li>
            <li><a class="dropdown-item" href="#">Thông tin lớp giảng dạy</a></li>
            <li><a class="dropdown-item" href="#">Lương hợp đồng</a></li>
            <li><a class="dropdown-item" href="#">Lịch sử thay đổi</a></li>
          </ul>
        </div>
        <div class="dropdown">
          <button class="btn btn-primary dropdown-toggle mx-1" type="button" id="dropdownMenuButton"
            data-bs-toggle="dropdown" aria-expanded="false">
            Quản lí giảng dạy
          </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <li><a class="dropdown-item" href="#">Quản lí môn học</a></li>
            <li><a class="dropdown-item" href="#">Quản lí lớp học</a></li>
            <li><a class="dropdown-item" href="#">Quản lí đề thi</a></li>
            <li><a class="dropdown-item" href="#">Quản lí coi thi</a></li>
            <li><a class="dropdown-item" href="#">Quản lí chấm thi</a></li>
          </ul>
        </div>
        <a href="#" class="btn btn-primary mx-1 text-nowrap">Tin Tức</a>
      </div>
      <div class="my-2 grid-center"><a href="#" class="mx-1 justify-content-end text-nowrap">Hi, Lê Đức...</a>
      </div>
    </div>
  </nav>

  <div class="container-fluid my-4">
    <div class="row">
      <div class="d-flex">
        <div class="bg-light mb-4 w-20">
          <h4>Chủ đề</h4>
          <ul class="nav nav-tabs list-group" id="myTab" role="tablist">
            <!-- Nội dung tab sẽ giữ nguyên -->
          </ul>
        </div>
        <div class="mx-3">
          <button id="infoGvm" class="btn btn-primary mb-3">Xem</button>

          <input type="text" id="filterName" placeholder="Nhập tên giảng viên để tìm" oninput="filterByName()"
            class="form-control mb-3" />
          <div id="renderInfo">
            <table class="table table-bordered text-center" style="width: 100%;">
              <thead>
                <tr>
                  <th>Học phần</th>
                  <th>Số TC</th>
                  <th>GV theo TKB</th>
                  <th>GV mời?</th>
                  <th>GV giảng dạy</th>
                  <th>Khoa</th>
                  <th>Bộ môn</th>
                  <th>Số tiết LL</th>
                  <th>Số tiết QC</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <!-- Dữ liệu sẽ được chèn vào đây -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    let globalData = []; // Biến toàn cục để lưu dữ liệu từ server

    // Hàm khởi động ứng dụng
    function init() {
      document.getElementById('infoGvm').addEventListener('click', loadData);
    }

    // Hàm tải dữ liệu từ server
    function loadData() {
      // Fetch dữ liệu giảng dạy
      fetch('http://localhost:3000/index/teaching-info')
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          globalData = data;
          console.log(data);
          renderTable(globalData); // Sử dụng hàm render mới
        })
        .catch(error => {
          console.error('Đã có lỗi xảy ra:', error);
        });
    }

    function renderTable(data) {
      const tableBody = document.getElementById('tableBody');
      tableBody.innerHTML = ''; // Xóa nội dung cũ

      data.forEach((row) => {
        const tableRow = document.createElement('tr');

        const lopHocPhanTd = document.createElement('td');
        lopHocPhanTd.textContent = row.LopHocPhan || '';
        tableRow.appendChild(lopHocPhanTd);

        const soTcTd = document.createElement('td');
        soTcTd.textContent = row.SoTinChi || '';
        tableRow.appendChild(soTcTd);

        const giaoVienTd = document.createElement('td');
        giaoVienTd.textContent = row.GiaoVien || '';
        tableRow.appendChild(giaoVienTd);

        const moiGiangTd = document.createElement('td');
        moiGiangTd.textContent = row.MoiGiang ? 'Có' : 'Không'; // Hiển thị 'Có' hoặc 'Không' thay vì checkbox
        tableRow.appendChild(moiGiangTd);

        const giaoVienGiangDayTd = document.createElement('td');
        giaoVienGiangDayTd.textContent = row.GiaoVienGiangDay || ''; // Hiển thị tên giảng viên giảng dạy, nếu không có thì để trống
        tableRow.appendChild(giaoVienGiangDayTd); c

        const khoaTd = document.createElement('td');
        khoaTd.textContent = row.Khoa || 'CNTT'; // Sử dụng dữ liệu thực tế cho khoa
        tableRow.appendChild(khoaTd);

        const boMonTd = document.createElement('td');
        boMonTd.textContent = ""; // Hiển thị thông tin bộ môn
        tableRow.appendChild(boMonTd);

        // test commit
        const soTietLTTd = document.createElement('td');
        soTietLTTd.textContent = row.LL || ''; // Hiển thị số tiết lý thuyết
        tableRow.appendChild(soTietLTTd);

        const soTietQCTd = document.createElement('td');
        soTietQCTd.textContent = row.QuyChuan || ''; // Hiển thị số tiết thực hành
        tableRow.appendChild(soTietQCTd);

        tableBody.appendChild(tableRow);
      });
    }

    function filterByName() {
      const input = document.getElementById('filterName');
      const filter = input.value.toLowerCase();
      const filteredData = globalData.filter(row => {
        return row.GiaoVien.toLowerCase().includes(filter);
      });
      renderTable(filteredData);
    }

    init();
  </script>
</body>

</html>